<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>スプレッドシートの表示</title>
  <style>
    table { border-collapse: collapse; }
    td, th { border: 1px solid #aaa; padding: 4px; }
  </style>
</head>
<body>
  <h1>スプレッドシートの内容（A1:U8）</h1>
  <div id="sheetData">Loading...</div>

  <script>
  fetch("https://script.google.com/macros/s/AKfycbwBo4J-AWIyT9P8m6fvMQkWin-TTZ5uGZZOufarSmKll3QQuAJF4_uGda7LTwAEB7mQ4g/exec")
    .then(res => res.json())
    .then(data => {
      const table = document.createElement("table");
      data.forEach(row => {
        const tr = document.createElement("tr");
        row.forEach(cell => {
          const td = document.createElement("td");

          if (cell === "") {
            const button = document.createElement("button");
            button.textContent = "○";
            button.addEventListener("click", () => {
              alert("ここに予約フォームを表示できます！");
            });
            td.appendChild(button);
          } else {
            td.textContent = cell;
          }

          tr.appendChild(td);
        });
        table.appendChild(tr);
      });
      document.getElementById("sheetData").innerHTML = "";
      document.getElementById("sheetData").appendChild(table);
    })
    .catch(err => {
      document.getElementById("sheetData").textContent = "エラー：" + err;
    });
</script>
</body>
</html>
