<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>スプレッドシートの表示</title>

  <style>
  table { border-collapse: collapse; }
  td, th {
    border: 1px solid #aaa;
    padding: 6px 10px;
    text-align: center;
  }
  th {
    background-color: #f0f0f0;
    font-weight: bold;
  }
  button {
    padding: 4px 8px;
    font-size: 14px;
    cursor: pointer;
  }
</style>

</head>
<body>
  <h1>スプレッドシートの内容</h1>
  <div id="sheetData">Loading...</div>

<script>
  fetch("https://script.google.com/macros/s/AKfycbwRX1MK72BL0P74bBhSN_LWRoNsiZd_dZiUCsdj_jHWGRS8fV8cGuBWMvkWju2EoPCRkg/exec")
    .then(res => res.json())
    .then(data => {
      const table = document.createElement("table");

      data.forEach((row, rowIndex) => {
        const tr = document.createElement("tr");

        row.forEach((cell, colIndex) => {
          const isHeader = rowIndex === 0 || colIndex === 0;
          const cellElement = document.createElement(isHeader ? "th" : "td");
          // 日付や時間の形式を調整
          if (cell instanceof String && cell.includes('/')) {
            // "MM/dd"の形式に変換
            cell = cell;
          } else if (cell instanceof String && cell.includes(':')) {
            // "HH:mm"の形式に変換
            const [hours, minutes] = cell.split(":");
            cell = `${hours.padStart(2, '0')}:${minutes.padStart(2, '0')}`;
          } else if (cell instanceof Date) {
            // Date型の日付を「MM/dd」に変換
            const date = new Date(cell);
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            cell = `${month}/${day}`;
          }

          
          if (!isHeader) {
            if (cell === "") {
              // ○ボタン + 黄緑背景
              const button = document.createElement("button");
              button.textContent = "○";
              button.addEventListener("click", () => {
                alert(`予約フォームを表示（${data[0][colIndex]} ${data[rowIndex][0]}）`);
              });
              cellElement.appendChild(button);
              cellElement.style.backgroundColor = "#ccffcc"; // 黄緑
            } else if (cell === "×") {
              cellElement.textContent = cell;
              cellElement.style.backgroundColor = "#ddd"; // 灰色
            } else {
              cellElement.textContent = cell;
              cellElement.style.backgroundColor = "#ffcccc"; // 赤
            }
          } else {
            cellElement.textContent = cell;
          }

          tr.appendChild(cellElement);
        });

        table.appendChild(tr);
      });

      document.getElementById("sheetData").innerHTML = "";
      document.getElementById("sheetData").appendChild(table);
    })
    .catch(err => {
      document.getElementById("sheetData").textContent = "エラー：" + err;
    });
</script>


</body>
</html>
